

# 📘 README.md（可直接使用）


# 🔬 化工原理干燥实验 — 数据自动处理脚本

本项目用于 **自动化处理干燥实验数据**，基于 Python 实现。  
脚本能够从实验记录表（Excel）中读取原始数据，完成完整的数据处理流程：

- 自动计算含水量 X、平均含水量 X_av  
- 计算干燥速率 U  
- 自动识别恒速干燥段  
- 求临界含水量 Xc、恒速干燥速率 Uc  
- 计算对流传热系数 h  
- 计算孔板体积流量 Q₀、干燥器内体积流量 Q 和空气流速 v  
- 自动绘制干燥曲线 (X–t) 和干燥速率曲线 (U–X_av)  
- 将所有处理结果导出到 Excel 文件  

适用于《化工原理》课程中的“干燥实验（对流干燥）”。

---

## 📁 项目结构


````
.
├── main.py                         # 主程序：读取数据、处理、绘图、导出
├── 干燥数据.xlsx                    # 实验原始数据（用户提供）
├── 干燥数据_处理结果.xlsx           # 自动生成的处理结果（运行后出现）
├── 干燥曲线_X_t.png                 # 生成的干燥曲线
└── 干燥速率曲线_U_Xav.png           # 生成的干燥速率曲线

````

---

## 📌 环境要求

建议使用 Python ≥ 3.8  
所需 Python 包如下：

```bash
pip install numpy pandas matplotlib openpyxl
````

---

## 🧪 数据格式要求（干燥数据.xlsx）

脚本要求你的原始 Excel 表格包含以下列名：

| 列名         | 含义            |
| ---------- | ------------- |
| `time_min` | 时间（min）       |
| `GT_g`     | 试样 + 支架总质量（g） |
| `湿球温度摄氏度`  | 湿球温度（℃）       |
| `压差（kpa）`  | 孔板两端压差（kPa）   |
| `干球温度`     | 干球温度（℃）       |
| `入口温度`     | 入口空气温度（℃）     |

这些字段从实验仪器直接读出即可，无需预处理。

---

## ⚙️ 配置实验常数

在 `main.py` 文件开头，你需要根据自己的实验填写以下参数：

```python
GD = 87.6        # 支撑架重量（g）
GC = 18.9        # 绝干物料重量（g）
S = 0.17 * 0.080 * 2  # 干燥面积（m^2）

C0 = 0.65        # 孔板流量计的流量系数
d0 = 0.035       # 孔径（m）
A_tunnel = 0.15 * 0.20  # 干燥室截面积（m^2）
```

这些数值可从 **实验装置说明书** 和 **实验步骤** 中获得。

---

## ▶️ 使用方法

1. 将你的实验原始数据保存为 `干燥数据.xlsx`
2. 根据实验具体条件修改 `main.py` 最开头的实验常数
3. 在终端执行：

```bash
python main.py
```

执行完毕后，脚本会自动生成：

* `干燥数据_处理结果.xlsx`（包含所有计算结果）
* `干燥曲线_X_t.png`
* `干燥速率曲线_U_Xav.png`

并在控制台输出：

* 恒速干燥速率 Uc
* 临界含水量 Xc
* 对流传热系数 h
* 孔板流量 Q₀、干燥室流量 Q、空气流速 v

---

## 📊 输出文件说明

### 1. 干燥数据_处理结果.xlsx

包含两张表：

* **处理数据**：每个时间点对应的 Gi、X、X_av、U 等全部中间数据
* **计算结果**：Xc、Uc、h、Q₀、Q、v 等关键参数

### 2. 图像文件

* `干燥曲线_X_t.png`
* `干燥速率曲线_U_Xav.png`

适合直接用于实验报告。

---

## 📈 示例：输出图像（运行脚本后会自动生成）

（你的运行后自动生成的图片会存放在项目根目录）

---

## 🛠️ 中文字体提示

若 matplotlib 中中文或上标字符出现 `missing glyph` 警告，可在代码开头加上：

```python
from matplotlib import rcParams
rcParams['font.sans-serif'] = ['SimHei']
rcParams['axes.unicode_minus'] = False
```

并将单位改写为：

```
kg/(m^2·s)
U × 1e4
```

可避免所有字体警告。

---

